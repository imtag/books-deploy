import{_ as s,c as a,o as n,d as p}from"./app.c4f45da1.js";const m=JSON.parse('{"title":"\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570","description":"","frontmatter":{},"headers":[{"level":3,"title":"\u6293\u5305\u5206\u6790","slug":"\u6293\u5305\u5206\u6790","link":"#\u6293\u5305\u5206\u6790","children":[]},{"level":3,"title":"\u4EE3\u7801\u5B9E\u73B0","slug":"\u4EE3\u7801\u5B9E\u73B0","link":"#\u4EE3\u7801\u5B9E\u73B0","children":[]}],"relativePath":"\u5176\u4ED6/\u57FA\u4E8E Python \u5B9E\u73B0\u5FAE\u4FE1\u516C\u4F17\u53F7\u722C\u866B/\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570.md"}'),l={name:"\u5176\u4ED6/\u57FA\u4E8E Python \u5B9E\u73B0\u5FAE\u4FE1\u516C\u4F17\u53F7\u722C\u866B/\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570.md"},e=p(`<h1 id="\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570" tabindex="-1">\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570 <a class="header-anchor" href="#\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570" aria-hidden="true">#</a></h1><hr><h1 id="\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570-1" tabindex="-1">\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570 <a class="header-anchor" href="#\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u3001\u8D5E\u8D4F\u6570-1" aria-hidden="true">#</a></h1><p>\u5982\u679C\u53EA\u662F\u83B7\u53D6\u6240\u6709\u6587\u7AE0\u7684\u57FA\u672C\u4FE1\u606F\u4EF7\u503C\u5E76\u4E0D\u5927\uFF0C\u6700\u591A\u80FD\u5BF9\u6587\u7AE0\u505A\u68C0\u7D22\uFF0C\u53EA\u6709\u5F97\u5230\u6587\u7AE0\u7684\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8BC4\u8BBA\u6570\u548C\u8D5E\u8D4F\u6570\u4E4B\u540E\u6570\u636E\u624D\u6709\u6570\u636E\u5206\u6790\u7684\u4EF7\u503C\u3002\u8FD9\u8282\u5C31\u6765\u8BA8\u8BBA\u5982\u4F55\u83B7\u53D6\u8FD9\u4E9B\u6570\u636E\u3002</p><h3 id="\u6293\u5305\u5206\u6790" tabindex="-1">\u6293\u5305\u5206\u6790 <a class="header-anchor" href="#\u6293\u5305\u5206\u6790" aria-hidden="true">#</a></h3><p>\u70B9\u5F00\u4EFB\u610F\u4E00\u7BC7\u6587\u7AE0\uFF0C\u901A\u8FC7 Fiddler \u6216 Charles \u6293\u5305\u5206\u6790\uFF0C\u9010\u4E2A\u5206\u6790\u6BCF\u4E2A\u8BF7\u6C42\uFF0C\u901A\u8FC7\u89C2\u5BDF\u53D1\u73B0\u83B7\u53D6\u6587\u7AE0\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u7684URL\u63A5\u53E3\u4E3A\uFF08\u6211\u4EEC\u547D\u540D\u4E3A data_url\uFF09\uFF1A<a href="https://mp.weixin.qq.com/mp/getappmsgext" target="_blank" rel="noreferrer">https://mp.weixin.qq.com/mp/getappmsgext</a> \uFF0C\u540E\u9762\u6709\u5F88\u591A\u67E5\u8BE2\u53C2\u6570\uFF0C\u8BF7\u6C42\u65B9\u6CD5\u4E3A POST</p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/1/4/160bfdc73a91ccf2~tplv-t2oaga2asx-image.image" alt=""></p><p>\u8BE5\u8BF7\u6C42\u7684\u67E5\u8BE2\u53C2\u6570\u670928\u4E2A\u4E4B\u591A\uFF0C\u53E6\u5916\u8FD8\u9644\u6709\u8BF7\u6C42 Body\u3002</p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/1/4/160bfdcc3f9674dd~tplv-t2oaga2asx-image.image" alt=""></p><p>\u8FD4\u56DE\u7684\u54CD\u5E94\u6570\u636E\u662FJSON\u683C\u5F0F\uFF0C\u6839\u636E\u5B57\u6BB5\u540D\u79F0\u57FA\u672C\u80FD\u731C\u51FA\u5176\u4E2D\u7684\u610F\u4E49\uFF0C\u9605\u8BFB\u6570\u3001\u70B9\u8D5E\u6570\u3001\u8D5E\u8D4F\u6570\u90FD\u5305\u542B\u5728\u5176\u4E2D</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;advertisement_num&quot;: 0, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;advertisement_info&quot;: [ ], </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;appmsgstat&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;show&quot;: true, </span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;is_login&quot;: true, </span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;liked&quot;: false, </span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;read_num&quot;: 6395,  # \u9605\u8BFB\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;like_num&quot;: 190,   # \u70B9\u8D5E\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;ret&quot;: 0, </span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;real_read_num&quot;: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">    }, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;comment_enabled&quot;: 1, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;timestamp&quot;: 1514972862, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;reward_head_imgs&quot;: [  # \u8D5E\u8D4F\u5934\u50CF\u5217\u8868</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;http://wx.qlogo.cn/mmhead/V3bYdzb7P4DLf3e7Xf74qSicESO8QdeupE5ibs8YI6xibE/132&quot;, </span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;http://wx.qlogo.cn/mmhead/Q3auHgzwzM7KF8PIsOicjLuRpsRzFhibeKs3sHFJGKkxDguAnF2gQJdA/132&quot;, </span></span>
<span class="line"><span style="color:#A6ACCD;">    ], </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;reward_total_count&quot;: 16,  # \u8D5E\u8D4F\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;can_reward&quot;: 1, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;only_fans_can_comment&quot;: true, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;user_can_reward&quot;: 1, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;reward_qrcode_ticket&quot;: &quot;%2B%2FfLw%2BXXGQwDD0ik6GwpMhSzLBMFCkwhjpXhStXNjXo%3D&quot;, </span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;base_resp&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;wxtoken&quot;: 723698581</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u786E\u5B9A\u4E86\u8BF7\u6C42\u7684URL\u53CA\u67E5\u8BE2\u53C2\u6570\uFF0C\u8BF7\u6C42\u65B9\u6CD5\uFF0C\u8BF7\u6C42\u4F53\uFF0C\u8BF7\u6C42\u5934\u4E5F\u80FD\u67E5\u770B\u5230\uFF0C\u8FD4\u56DE\u7684\u6570\u636E\u4E5F\u6709\u4E86\uFF0C\u5269\u4E0B\u7684\u95EE\u9898\u662F\u5982\u4F55\u6279\u91CF\u83B7\u53D6\u4E0D\u540C\u6587\u7AE0\u7684\u6570\u636E\uFF0C\u8FD9\u9700\u8981\u4ECE\u8BF7\u6C42\u7684 data_url \u7740\u624B\u5206\u6790\u3002</p><p>\u4E3A\u4E86\u627E\u51FA data_url \u4E2D\u67E5\u8BE2\u53C2\u6570\u7684\u89C4\u5F8B\uFF0C\u5148\u5BF9\u6BD4\u6587\u7AE0\u8BE6\u60C5\u7684 content_url \uFF08\u5C31\u662F\u5728\u4E0A\u4E00\u8282\u5F97\u5230\u7684\u6587\u7AE0\u8BE6\u60C5URL\uFF09</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># \u6587\u7AE0\u7684URL</span></span>
<span class="line"><span style="color:#A6ACCD;">content_url = &quot;http://mp.weixin.qq.com/s?&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">              &quot;__biz=MjM5MzgyODQxMQ==&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">              &quot;mid=2650367413&amp;idx=1&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">              &quot;sn=637de06b162c21605eef3db41ee4a1bb&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">              &quot;chksm=be9cdee189eb57f78994371ce1b5b42656bf77160eeee592507df06bae0cea58b542aeabe0a4&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">              &quot;scene=27&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u4E0D\u5F97\u800C\u77E5\uFF0C<code>__biz</code>\uFF0Cmid\uFF0Cidx\uFF0Csn\uFF0Cscene\uFF0Cchksm \u662F\u6784\u6210\u4E00\u7BC7\u6587\u7AE0\u7684\u5B8C\u6574URL\uFF0C\u800C\u6587\u7AE0\u9605\u8BFB\u6570\u7684URL\u662F\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># \u9605\u8BFB\u6570URL</span></span>
<span class="line"><span style="color:#A6ACCD;">data_url = &quot;https://mp.weixin.qq.com/mp/getappmsgext?&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;__biz=MjM5MzgyODQxMQ==&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;appmsg_type=9&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;mid=2650367720&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;sn=87e32a97392f320c17960c31f1035182&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;idx=1&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;scene=27&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;title=2018%20%E5%B9%B4%EF%BC%8C%E5%AD%A6%E7%82%B9%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%EF%BC%88%E8%B5%A0%E4%B9%A68%E6%9C%AC%EF%BC%89&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;ct=1514505600&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;abtest_cookie=AwABAAoADAANAAkAJIgeAGKIHgD8iB4Ab4keAPiJHgAHih4AD4oeAEyKHgBdih4AAAA=&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;devicetype=iOS10.3.3&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;version=/mmbizwap/zh_CN/htmledition/js/appmsg/index3a9713.js&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;f=json&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;r=0.341679623927889&amp;is_need_ad=0&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;comment_id=2810810222&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;is_need_reward=1&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;both_ad=0&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;reward_uin_count=27&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;msg_daily_idx=1&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;is_original=0&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;uin=777&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;key=777&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;pass_ticket=y0QRNge7UkQaFPA9SKuvpeee2eNqvasPGVmFo9z8MUBt4ApaTKt0Ps38VaDKpqQ6&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;wxtoken=217065932&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;devicetype=iOS10.3.3&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;clientversion=16060123&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;appmsg_token=938_vSjt2FisNybtpLZCYw5DGyn0L2PK7qpCkzVlZySGKUjQDC0UMw3SNoS1Atum66a7ElZYWWb5amRtAy8m&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;x5=0&amp;&quot; \\</span></span>
<span class="line"><span style="color:#A6ACCD;">           &quot;f=json&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u5BF9\u6BD4\u4E24\u4E2AURL\uFF0C\u4F60\u4F1A\u53D1\u73B0 content_url \u4E2D\u7684\u53C2\u6570\u9664\u4E86 chksm \u5176\u5B83\u51E0\u4E2A\u53C2\u6570\u90FD\u5728 data_url \u4E2D\uFF0C\u6211\u4EEC\u628A content_url \u4E2D\u7684\u53C2\u6570\u66FF\u6362\u5230 data_url \u518D\u6765\u9A8C\u8BC1\u8BF7\u6C42\u4F1A\u4E0D\u4F1A\u6B63\u5E38\u8FD4\u56DE\u6570\u636E\u3002\u81F3\u4E8E\u5176\u4ED6\u53C2\u6570\u8981\u4E0D\u8981\u6539\uFF0C\u600E\u4E48\u6539\u6211\u4EEC\u5148\u653E\u4E00\u8FB9\uFF08\u8FD9\u662F\u4E00\u4E2A\u4E0D\u65AD\u731C\u60F3\u3001\u9A8C\u8BC1\u7684\u8FC7\u7A0B\uFF0C\u7ECF\u8FC7\u6211\u7684\u591A\u6B21\u8BD5\u9A8C\uFF0C\u9664\u4E86 appmsg_token \u6709\u4E00\u5B9A\u7684\u65F6\u6548\u4E4B\u5916\uFF0C\u5176\u5B83\u503C\u53EF\u4EE5\u4FDD\u6301\u4E0D\u53D8\uFF0C\u4E5F\u5C31\u662F\u8BF4\u4E0D\u540C\u7684\u6587\u7AE0\uFF0C\u53EA\u8981\u628Acontent_url\u4E2D\u7684\u53C2\u6570\u66FF\u6362\u5230 data_url \u4E2D\u5C31\u53EF\u4EE5\u83B7\u53D6\u8BE5\u6587\u7AE0\u7684\u6570\u636E\u4E86\u3002\uFF09</p><h3 id="\u4EE3\u7801\u5B9E\u73B0" tabindex="-1">\u4EE3\u7801\u5B9E\u73B0 <a class="header-anchor" href="#\u4EE3\u7801\u5B9E\u73B0" aria-hidden="true">#</a></h3><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">    @staticmethod</span></span>
<span class="line"><span style="color:#A6ACCD;">    def update_post(post):</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        post \u53C2\u6570\u662F\u4ECEmongodb\u8BFB\u53D6\u51FA\u6765\u7684\u4E00\u6761\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">        \u7A0D\u540E\u5C31\u662F\u5BF9\u8FD9\u4E2A\u5BF9\u8C61\u8FDB\u884C\u66F4\u65B0\u4FDD\u5B58</span></span>
<span class="line"><span style="color:#A6ACCD;">        :param post:</span></span>
<span class="line"><span style="color:#A6ACCD;">        :return:</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        # \u8FD9\u4E2A\u53C2\u6570\u662F\u6211\u4ECEFiddler\u4E2D\u62F7\u8D1D\u51FA URL\uFF0C\u7136\u540E\u63D0\u53D6\u51FA\u67E5\u8BE2\u53C2\u6570\u90E8\u5206\u518D\u8F6C\u6362\u6210\u5B57\u5178\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#A6ACCD;">        # \u7A0D\u540E\u4F1A\u4F5C\u4E3A\u53C2\u6570\u4F20\u7ED9request.post\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#A6ACCD;">        data_url_params = {&#39;__biz&#39;: &#39;MjM5MzgyODQxMQ==&#39;, &#39;appmsg_type&#39;: &#39;9&#39;, &#39;mid&#39;: &#39;2650367727&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;sn&#39;: &#39;08ce54f6f36873e74c638421012bb495&#39;, &#39;idx&#39;: &#39;1&#39;, &#39;scene&#39;: &#39;0&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;title&#39;: &#39;2017%E5%B9%B4%EF%BC%8C%E6%84%9F%E8%B0%A2%E4%BD%A0%E4%BB%AC%EF%BC%8C2018%E5%B9%B4%EF%BC%8C%E6%88%91%E4%BB%AC%E7%BB%A7%E7%BB%AD%E5%8A%AA%E5%8A%9B%E5%89%8D%E8%A1%8C&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;ct&#39;: &#39;1514796292&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;abtest_cookie&#39;: &#39;AwABAAoADAANAAgAJIgeALuIHgDhiB4A/IgeAPqJHgANih4ATYoeAF6KHgAAAA==&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;devicetype&#39;: &#39;android-24&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;version&#39;: &#39;/mmbizwap/zh_CN/htmledition/js/appmsg/index3a9713.js&#39;, &#39;f&#39;: &#39;json&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;r&#39;: &#39;0.6452677228890584&#39;, &#39;is_need_ad&#39;: &#39;1&#39;, &#39;comment_id&#39;: &#39;1741225191&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;is_need_reward&#39;: &#39;1&#39;, &#39;both_ad&#39;: &#39;0&#39;, &#39;reward_uin_count&#39;: &#39;24&#39;, &#39;msg_daily_idx&#39;: &#39;1&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;is_original&#39;: &#39;0&#39;, &#39;uin&#39;: &#39;777&#39;, &#39;key&#39;: &#39;777&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;pass_ticket&#39;: &#39;mXHYjLnkYux1rXx8BxNrZpgW4W%252ByLZxcuvpDWlxbBrjvJo3ECB%252BckDAsy%252FTJJK6P&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;wxtoken&#39;: &#39;1805512665&#39;, &#39;clientversion&#39;: &#39;26060133&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;appmsg_token&#39;: &#39;938_VN3Rr7O4RIU7lm%2F8_amSJbZBo3RJXACjIMDwDu5ZPbSm2_SW6RpnZGb2Vrp6ECxr9y5QoVCI7H-iQotJ&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">                           &#39;x5&#39;: &#39;1&#39;}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        # url\u8F6C\u4E49\u5904\u7406</span></span>
<span class="line"><span style="color:#A6ACCD;">        content_url = html.unescape(post.content_url)</span></span>
<span class="line"><span style="color:#A6ACCD;">        # \u622A\u53D6content_url\u7684\u67E5\u8BE2\u53C2\u6570\u90E8\u5206</span></span>
<span class="line"><span style="color:#A6ACCD;">        content_url_params = urlsplit(content_url).query</span></span>
<span class="line"><span style="color:#A6ACCD;">        # \u5C06\u53C2\u6570\u8F6C\u5316\u4E3A\u5B57\u5178\u7C7B\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">        content_url_params = utils.str_to_dict(content_url_params, &quot;&amp;&quot;, &quot;=&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        # \u66F4\u65B0\u5230data_url</span></span>
<span class="line"><span style="color:#A6ACCD;">        data_url_params.update(content_url_params)</span></span>
<span class="line"><span style="color:#A6ACCD;">        body = &quot;is_only_read=1&amp;req_id=03230SZyTR8kQlPVkKwxbt1A&amp;pass_ticket=mXHYjLnkYux1rXx8BxNrZpgW4W%25252ByLZxcuvpDWlxbBrjvJo3ECB%25252BckDAsy%25252FTJJK6P&amp;is_temp_url=0&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        data = utils.str_to_dict(body, &quot;&amp;&quot;, &quot;=&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        headers = &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: mp.weixin.qq.com</span></span>
<span class="line"><span style="color:#A6ACCD;">Connection: keep-alive</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 155</span></span>
<span class="line"><span style="color:#A6ACCD;">Origin: https://mp.weixin.qq.com</span></span>
<span class="line"><span style="color:#A6ACCD;">X-Requested-With: XMLHttpRequest</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Linux; Android 7.0; M1 E Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043632 Safari/537.36 MicroMessenger/6.6.1.1220(0x26060133) NetType/WIFI Language/zh_CN</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: */*</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: https://mp.weixin.qq.com/s?__biz=MjM5MzgyODQxMQ==&amp;mid=2650367727&amp;idx=1&amp;sn=08ce54f6f36873e74c638421012bb495&amp;chksm=be9cddbb89eb54ad436af5c27c0d0db06da7e3aec613a33dd99f935d684a77b555241207f1ba&amp;scene=0&amp;ascene=7&amp;devicetype=android-24&amp;version=26060133&amp;nettype=WIFI&amp;abtest_cookie=AwABAAoADAANAAgAJIgeALuIHgDhiB4A%2FIgeAPqJHgANih4ATYoeAF6KHgAAAA%3D%3D&amp;lang=zh_CN&amp;pass_ticket=mXHYjLnkYux1rXx8BxNrZpgW4W%2ByLZxcuvpDWlxbBrjvJo3ECB%2BckDAsy%2FTJJK6P&amp;wx_header=1</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: zh-CN,en-US;q=0.8</span></span>
<span class="line"><span style="color:#A6ACCD;">Cookie: rewardsn=05c38771473771b68376; wxtokenkey=92c034f1d4d5cfe011a9222522d96c3af508a6e35160b5f6fefa185431bda832; wxuin=525477518; devicetype=android-24; version=26060133; lang=zh_CN; pass_ticket=mXHYjLnkYux1rXx8BxNrZpgW4W+yLZxcuvpDWlxbBrjvJo3ECB+ckDAsy/TJJK6P; wap_sid2=CI7NyPoBElx2ZFNJVXFOVFh2S3U5X1hLS2pZb2Z0Ujd1NTBPdlMzbEpwMjdVRlYtTHluRWkwZzIwUzY4ZVM3Y294MzU5aDM5eWxfRWVKOVJoY0dvVmZuQTk2S1JLS29EQUFBfjCQ5LPSBTgNQAE=</span></span>
<span class="line"><span style="color:#A6ACCD;">Q-UA2: QV=3&amp;PL=ADR&amp;PR=WX&amp;PP=com.tencent.mm&amp;PPVN=6.6.1&amp;TBSVC=43602&amp;CO=BK&amp;COVC=043632&amp;PB=GE&amp;VE=GA&amp;DE=PHONE&amp;CHID=0&amp;LCID=9422&amp;MO= M1E &amp;RL=1080*1920&amp;OS=7.0&amp;API=24</span></span>
<span class="line"><span style="color:#A6ACCD;">Q-GUID: 0fd685fa8c515a30dd9f7caf13b788cb</span></span>
<span class="line"><span style="color:#A6ACCD;">Q-Auth: 31045b957cf33acf31e40be2f3e71c5217597676a9729f1b</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        headers = utils.str_to_dict(headers)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        data_url = &quot;https://mp.weixin.qq.com/mp/getappmsgext&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        r = requests.post(data_url, data=data, verify=False, params=data_url_params, headers=headers)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        result = r.json()</span></span>
<span class="line"><span style="color:#A6ACCD;">        if result.get(&quot;appmsgstat&quot;):</span></span>
<span class="line"><span style="color:#A6ACCD;">            post[&#39;read_num&#39;] = result.get(&quot;appmsgstat&quot;).get(&quot;read_num&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            post[&#39;like_num&#39;] = result.get(&quot;appmsgstat&quot;).get(&quot;like_num&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            post[&#39;reward_num&#39;] = result.get(&quot;reward_total_count&quot;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            post[&#39;u_date&#39;] = datetime.now()</span></span>
<span class="line"><span style="color:#A6ACCD;">            logger.info(&quot;\u300C%s\u300Dread_num: %s like_num: %s reward_num: %s&quot; %</span></span>
<span class="line"><span style="color:#A6ACCD;">                        (post.title, post[&#39;read_num&#39;], post[&#39;like_num&#39;], post[&#39;reward_num&#39;]))</span></span>
<span class="line"><span style="color:#A6ACCD;">            post.save()</span></span>
<span class="line"><span style="color:#A6ACCD;">        else:</span></span>
<span class="line"><span style="color:#A6ACCD;">            logger.warning(u&quot;\u6CA1\u6709\u83B7\u53D6\u7684\u771F\u5B9E\u6570\u636E\uFF0C\u8BF7\u68C0\u67E5\u8BF7\u6C42\u53C2\u6570\u662F\u5426\u6B63\u786E\uFF0C\u8FD4\u56DE\u7684\u6570\u636E\u4E3A\uFF1Adata=%s&quot; % r.text)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u9700\u8981\u6CE8\u610F\u7684\u662F iOS \u6CA1\u6709\u8D5E\u8D4F\u529F\u80FD\uFF0C\u6240\u4EE5\u5982\u679C\u8981\u83B7\u53D6\u8D5E\u8D4F\u6570\u636E\uFF0C\u6211\u4EEC\u5FC5\u987B\u7528 Android \u8BBE\u5907\u6765\u6293\u53D6\u6570\u636E\u3002\u73B0\u5728\u5C31\u6765\u904D\u5386\u66F4\u65B0\u6BCF\u6761\u6570\u636E\u7684\u5185\u5BB9\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">  crawler = WeiXinCrawler()</span></span>
<span class="line"><span style="color:#A6ACCD;">    for post in Post.objects(read_num=0):</span></span>
<span class="line"><span style="color:#A6ACCD;">        crawler.update_post(post)</span></span>
<span class="line"><span style="color:#A6ACCD;">        time.sleep(1) # \u9632\u6B62\u6076\u610F\u5237</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u4E0D\u51FA\u610F\u5916\u7684\u8BDD\uFF0C\u80FD\u6B63\u5E38\u83B7\u53D6\u5230\u6570\u636E\uFF0C\u5728\u6293\u53D6\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u5FAE\u4FE1\u4F1A\u6709\u53CD\u722C\u866B\u9650\u5236\uFF0C\u722C\u4E86\u4E00\u6BB5\u65F6\u95F4\u540E\uFF0C\u8FD4\u56DE\u7684\u6570\u636E\u6210\u4E86\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">{&quot;base_resp&quot;:{&quot;ret&quot;:301,&quot;errmsg&quot;:&quot;default&quot;}}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u8FD9\u4E2A\u65F6\u5019\u9700\u8981\u4F11\u606F\u4E00\u4F1A\u513F\u624D\u80FD\u7EE7\u7EED\u722C\u866B\uFF0C\u6362IP\u4E5F\u6CA1\u7528\uFF0C\u56E0\u4E3A\u5FAE\u4FE1\u4F1A\u6839\u636E\u4F60\u7684\u5FAE\u4FE1\u8D26\u53F7\u8FDB\u884C\u9650\u5236\uFF0C\u5982\u679C\u9700\u8981\u5927\u89C4\u6A21\u722C\u866B\u5C31\u6709\u5FC5\u8981\u51C6\u5907\u591A\u4E2A\u5FAE\u4FE1\u53F7\u6765\u64CD\u4F5C\u3002\u672C\u8282\u5B8C\u6574\u4EE3\u7801\uFF1A<a href="https://github.com/pythonzhichan/weixincrawler/tree/v0.4" target="_blank" rel="noreferrer">weixincrawler-v0.4</a></p>`,24),o=[e];function t(c,A,r,i,C,u){return n(),a("div",null,o)}const y=s(l,[["render",t]]);export{m as __pageData,y as default};

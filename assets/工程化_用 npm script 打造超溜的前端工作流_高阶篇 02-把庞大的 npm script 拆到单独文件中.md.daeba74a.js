import{_ as s,c as a,o as n,d as e}from"./app.c4f45da1.js";const A=JSON.parse('{"title":"\u9AD8\u9636\u7BC7 02-\u628A\u5E9E\u5927\u7684 npm script \u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D","description":"","frontmatter":{},"headers":[{"level":3,"title":"1. \u5B89\u88C5\u4F9D\u8D56","slug":"_1-\u5B89\u88C5\u4F9D\u8D56","link":"#_1-\u5B89\u88C5\u4F9D\u8D56","children":[]},{"level":3,"title":"2. \u51C6\u5907\u76EE\u5F55\u548C\u6587\u4EF6","slug":"_2-\u51C6\u5907\u76EE\u5F55\u548C\u6587\u4EF6","link":"#_2-\u51C6\u5907\u76EE\u5F55\u548C\u6587\u4EF6","children":[]},{"level":3,"title":"3. \u4FEE\u6539 scripty \u811A\u672C","slug":"_3-\u4FEE\u6539-scripty-\u811A\u672C","link":"#_3-\u4FEE\u6539-scripty-\u811A\u672C","children":[]},{"level":3,"title":"4. \u4FEE\u6539 package.json","slug":"_4-\u4FEE\u6539-package-json","link":"#_4-\u4FEE\u6539-package-json","children":[]},{"level":3,"title":"5. \u5B9E\u9645\u6D4B\u8BD5","slug":"_5-\u5B9E\u9645\u6D4B\u8BD5","link":"#_5-\u5B9E\u9645\u6D4B\u8BD5","children":[]},{"level":3,"title":"\u9AD8\u7EA7\u6280\u5DE7","slug":"\u9AD8\u7EA7\u6280\u5DE7","link":"#\u9AD8\u7EA7\u6280\u5DE7","children":[]}],"relativePath":"\u5DE5\u7A0B\u5316/\u7528 npm script \u6253\u9020\u8D85\u6E9C\u7684\u524D\u7AEF\u5DE5\u4F5C\u6D41/\u9AD8\u9636\u7BC7 02-\u628A\u5E9E\u5927\u7684 npm script \u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D.md"}'),p={name:"\u5DE5\u7A0B\u5316/\u7528 npm script \u6253\u9020\u8D85\u6E9C\u7684\u524D\u7AEF\u5DE5\u4F5C\u6D41/\u9AD8\u9636\u7BC7 02-\u628A\u5E9E\u5927\u7684 npm script \u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D.md"},o=e(`<h1 id="\u9AD8\u9636\u7BC7-02-\u628A\u5E9E\u5927\u7684-npm-script-\u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D" tabindex="-1">\u9AD8\u9636\u7BC7 02-\u628A\u5E9E\u5927\u7684 npm script \u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D <a class="header-anchor" href="#\u9AD8\u9636\u7BC7-02-\u628A\u5E9E\u5927\u7684-npm-script-\u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D" aria-hidden="true">#</a></h1><hr><h1 id="_3-2-\u628A\u5E9E\u5927\u7684-npm-script-\u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D" tabindex="-1">3.2 \u628A\u5E9E\u5927\u7684 npm script \u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D <a class="header-anchor" href="#_3-2-\u628A\u5E9E\u5927\u7684-npm-script-\u62C6\u5230\u5355\u72EC\u6587\u4EF6\u4E2D" aria-hidden="true">#</a></h1><p>\u5F53 npm script \u4E0D\u65AD\u7D2F\u79EF\u3001\u81A8\u80C0\u7684\u65F6\u5019\uFF0C\u5168\u90E8\u653E\u5728 package.json \u91CC\u9762\u53EF\u80FD\u5E76\u4E0D\u662F\u4E2A\u597D\u4E3B\u610F\uFF0C\u56E0\u4E3A\u8FD9\u6837\u4F1A\u5BFC\u81F4 package.json \u7CDF\u4E71\uFF0C\u53EF\u8BFB\u6027\u964D\u4F4E\u3002</p><p>\u501F\u52A9 <a href="https://github.com/testdouble/scripty" target="_blank" rel="noreferrer">scripty</a> \u6211\u4EEC\u53EF\u4EE5\u5C06 npm script \u5265\u79BB\u5230\u5355\u72EC\u7684\u6587\u4EF6\u4E2D\uFF0C\u4ECE\u800C\u628A\u590D\u6742\u6027\u9694\u5230\u5355\u72EC\u7684\u6A21\u5757\u91CC\u9762\uFF0C\u8BA9\u4EE3\u7801\u6574\u4F53\u770B\u8D77\u6765\u66F4\u52A0\u6E05\u6670\u3002</p><p>\u793A\u4F8B\u9879\u76EE\u4E2D\u7684\u8986\u76D6\u7387\u76F8\u5173\u7684 npm script \u5360\u636E\u4E86\u5F88\u5927\u7684\u7BC7\u5E45\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">  &quot;scripts&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;cover:cleanup&quot;: &quot;rimraf coverage &amp;&amp; rimraf .nyc_output&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;cover:archive&quot;: &quot;cross-var \\&quot;make-dir coverage_archive/$npm_package_version &amp;&amp; cpr coverage/* coverage_archive/$npm_package_version -o\\&quot;&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;cover:serve&quot;: &quot;cross-var http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;precover&quot;: &quot;npm run cover:cleanup&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;postcover&quot;: &quot;npm-run-all cover:archive --parallel cover:serve cover:open&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  },</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u5982\u679C\u8981\u9694\u79BB\u590D\u6742\u6027\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8003\u8651\u4ECE cover \u76F8\u5173\u7684 script \u5165\u624B\uFF0C\u5177\u4F53\u64CD\u4F5C\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><h3 id="_1-\u5B89\u88C5\u4F9D\u8D56" tabindex="-1">1. \u5B89\u88C5\u4F9D\u8D56 <a class="header-anchor" href="#_1-\u5B89\u88C5\u4F9D\u8D56" aria-hidden="true">#</a></h3><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">npm i scripty -D</span></span>
<span class="line"><span style="color:#A6ACCD;"># npm install scripty --save-dev</span></span>
<span class="line"><span style="color:#A6ACCD;"># yarn add scripty -D</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h3 id="_2-\u51C6\u5907\u76EE\u5F55\u548C\u6587\u4EF6" tabindex="-1">2. \u51C6\u5907\u76EE\u5F55\u548C\u6587\u4EF6 <a class="header-anchor" href="#_2-\u51C6\u5907\u76EE\u5F55\u548C\u6587\u4EF6" aria-hidden="true">#</a></h3><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">mkdir -p scripts/cover</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u5148\u521B\u5EFA\u4E24\u5C42\u7684\u76EE\u5F55\uFF0C\u56E0\u4E3A\u6211\u4EEC\u8BA1\u5212\u628A cover \u811A\u672C\u5199\u6210\u591A\u4E2A\uFF0C\u65B9\u4FBF\u5355\u72EC\u53BB\u6267\u884C\uFF0C\u8FD9\u91CC\u547D\u540D\u4E3A scripts \u662F scripty \u9ED8\u8BA4\u7684\uFF0C\u5B9E\u9645\u4E0A\u662F\u53EF\u4EE5\u81EA\u5B9A\u4E49\u7684\u3002</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">touch scripts/cover.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">touch scripts/cover/serve.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">touch scripts/cover/open.sh</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u7136\u540E\u521B\u5EFA\u7A7A\u767D\u7684\u811A\u672C\u6587\u4EF6\uFF0C\u56E0\u4E3A\u6709\u4E86\u5355\u72EC\u7684\u811A\u672C\uFF0C\u6211\u4EEC\u53EF\u4EE5\u628A\u539F\u6765\u7684 precover\u3001cover\u3001postcover\u3001cover:archive\u3001cover:cleanup \u5408\u5E76\u5230\u4E00\u4E2A\u6587\u4EF6\u4E2D\u3002</p><p>\u6309\u7167 scripty \u7684\u9ED8\u8BA4\u7EA6\u5B9A\uFF0Cnpm script \u547D\u4EE4\u548C\u4E0A\u9762\u5404\u6587\u4EF6\u7684\u5BF9\u5E94\u5173\u7CFB\u5982\u4E0B\uFF1A</p><table><thead><tr><th>\u547D\u4EE4</th><th>\u6587\u4EF6</th><th>\u5907\u6CE8</th></tr></thead><tbody><tr><td>cover</td><td>scripts/cover.sh</td><td>\u5185\u542B precover\u3001postcover \u7684\u903B\u8F91</td></tr><tr><td>cover:serve</td><td>scripts/cover/serve.sh</td><td>\u542F\u52A8\u670D\u52A1</td></tr><tr><td>cover:open</td><td>scripts/cover/open.sh</td><td>\u6253\u5F00\u9884\u89C8</td></tr></tbody></table><p><strong>\u7279\u522B\u6CE8\u610F\u7684\u662F\uFF0C\u7ED9\u6240\u6709\u811A\u672C\u589E\u52A0\u53EF\u6267\u884C\u6743\u9650\u662F\u5FC5\u987B\u7684\uFF0C\u5426\u5219 scripty \u6267\u884C\u65F6\u4F1A\u62A5\u9519</strong>\uFF0C\u6211\u4EEC\u53EF\u4EE5\u7ED9\u6240\u6709\u7684\u811A\u672C\u589E\u52A0\u53EF\u6267\u884C\u6743\u9650\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">chmod -R a+x scripts/**/*.sh</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h3 id="_3-\u4FEE\u6539-scripty-\u811A\u672C" tabindex="-1">3. \u4FEE\u6539 scripty \u811A\u672C <a class="header-anchor" href="#_3-\u4FEE\u6539-scripty-\u811A\u672C" aria-hidden="true">#</a></h3><p>\u51C6\u5907\u597D\u76EE\u5F55\u548C\u6587\u4EF6\u4E4B\u540E\uFF0C\u63A5\u4E0B\u6765\u9700\u8981\u7ED9\u811A\u672C\u586B\u5145\u5185\u5BB9\uFF0C\u811A\u672C\u5185\u5BB9\u5982\u4E0B\uFF08\u56E0\u4E3A\u811A\u672C\u4F7F\u7528\u7684\u662F bash\uFF0C\u6240\u4EE5\u76F4\u63A5\u5FFD\u7565\u4E86\u8DE8\u5E73\u53F0\u517C\u5BB9\u7684\u5904\u7406\uFF0C\u8DE8\u5E73\u53F0\u517C\u5BB9\u811A\u672C\u6700\u597D\u4F7F\u7528 Node.js \u7F16\u5199\uFF0C\u4E0B\u8282\u4F1A\u4ECB\u7ECD\uFF09\uFF1A</p><p><code>scripts/cover.sh</code> \u5185\u5BB9\u5982\u4E0B\uFF08cleanup --&gt; cover --&gt; archive --&gt; preview\uFF09\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">#!/usr/bin/env bash</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># remove old coverage reports</span></span>
<span class="line"><span style="color:#A6ACCD;">rimraf coverage &amp;&amp; rimraf .nyc_output</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># run test and collect new coverage</span></span>
<span class="line"><span style="color:#A6ACCD;">nyc --reporter=html npm run test</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># achive coverage report by version</span></span>
<span class="line"><span style="color:#A6ACCD;">mkdir -p coverage_archive/$npm_package_version</span></span>
<span class="line"><span style="color:#A6ACCD;">cp -r coverage/* coverage_archive/$npm_package_version</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># open coverage report for preview</span></span>
<span class="line"><span style="color:#A6ACCD;">npm-run-all --parallel cover:serve cover:open</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><code>scripts/cover/serve.sh</code> \u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">#!/usr/bin/env bash</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">http-server coverage_archive/$npm_package_version -p $npm_package_config_port</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><code>scripts/cover/open.sh</code> \u5185\u5BB9\u5982\u4E0B\uFF08\u8FD9\u91CC\u6709\u4E2A sleep\uFF0C\u662F\u4E3A\u4E86\u786E\u4FDD\u6587\u4EF6\u7CFB\u7EDF\u5199\u5165\u5B8C\u6210\uFF09\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">#!/usr/bin/env bash</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">sleep 1</span></span>
<span class="line"><span style="color:#A6ACCD;">opn http://localhost:$npm_package_config_port</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u7EC6\u5FC3\u7684\u540C\u5B66\u53EF\u80FD\u6CE8\u610F\u5230\u4E86\uFF0C\u5728 shell \u811A\u672C\u91CC\u9762\u662F\u53EF\u4EE5\u968F\u610F\u4F7F\u7528 npm \u7684\u5185\u7F6E\u53D8\u91CF\u548C\u81EA\u5B9A\u4E49\u53D8\u91CF\u7684\u3002</p><h3 id="_4-\u4FEE\u6539-package-json" tabindex="-1">4. \u4FEE\u6539 package.json <a class="header-anchor" href="#_4-\u4FEE\u6539-package-json" aria-hidden="true">#</a></h3><p>\u4E3B\u8981\u6539\u52A8\u662F\u6E05\u7406 cover:* \u547D\u4EE4\uFF0C\u63A5\u5165 scripty\uFF0C\u5177\u4F53\u7684 diff \u5982\u4E0B\uFF1A</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">   &quot;scripts&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;test&quot;: &quot;cross-env NODE_ENV=test mocha tests/&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;cover&quot;: &quot;nyc --reporter=html npm test&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;cover:cleanup&quot;: &quot;rimraf coverage &amp;&amp; rimraf .nyc_output&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;cover:archive&quot;: &quot;cross-var \\&quot;make-dir coverage_archive/$npm_package_version &amp;&amp; cpr coverage/* coverage_archive/$npm_package_version -o\\&quot;&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;cover:serve&quot;: &quot;cross-var http-server coverage_archive/$npm_package_version -p $npm_package_config_port&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;precover&quot;: &quot;npm run cover:cleanup&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">-    &quot;postcover&quot;: &quot;npm-run-all cover:archive --parallel cover:serve cover:open&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">+    &quot;cover&quot;: &quot;scripty&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">+    &quot;cover:serve&quot;: &quot;scripty&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">+    &quot;cover:open&quot;: &quot;scripty&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   },</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u8FD9\u91CC\u6211\u4EEC\u53EA\u4FDD\u7559\u4E86 cover\u3001cover:serve\u3001cover:open \u7B49 3 \u4E2A\u547D\u4EE4\uFF0C\u8BA9\u5B83\u4EEC\u90FD\u6307\u5411 scripty\uFF0C\u8C03\u7528\u54EA\u4E2A\u811A\u672C\u90FD\u7531 scripty \u6765\u5904\u7406\u3002</p><h3 id="_5-\u5B9E\u9645\u6D4B\u8BD5" tabindex="-1">5. \u5B9E\u9645\u6D4B\u8BD5 <a class="header-anchor" href="#_5-\u5B9E\u9645\u6D4B\u8BD5" aria-hidden="true">#</a></h3><p>\u4FEE\u6539\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u91CD\u65B0\u8FD0\u884C npm run cover\uFF0C\u4E0D\u51FA\u610F\u5916\u7684\u8BDD\uFF0C\u6211\u4EEC\u80FD\u5F97\u5230\u548C\u539F\u6765\u5B8C\u5168\u76F8\u540C\u7684\u7ED3\u679C\uFF0C\u4ED4\u7EC6\u89C2\u5BDF\u8FD0\u884C\u7684\u65E5\u5FD7\uFF0C\u4F1A\u53D1\u73B0\u5728\u4EE3\u7801\u6267\u884C\u524D\u6709\u6BB5\u989D\u5916\u7684\u8F93\u51FA\uFF0C\u5982\u4E0B\u56FE\u4E2D\u7EA2\u8272\u6846\u4E2D\u7684\u5185\u5BB9\uFF0Cscripty \u5728\u5B9E\u9645\u6267\u884C\u7684\u65F6\u5019\u4F1A\u628A\u6267\u884C\u7684\u547D\u4EE4\u5185\u5BB9\u6253\u5370\u51FA\u6765\uFF0C\u65B9\u4FBF\u8C03\u8BD5\uFF1A</p><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/7/1602e70a1b4df91b~tplv-t2oaga2asx-image.image" alt=""></p><h3 id="\u9AD8\u7EA7\u6280\u5DE7" tabindex="-1">\u9AD8\u7EA7\u6280\u5DE7 <a class="header-anchor" href="#\u9AD8\u7EA7\u6280\u5DE7" aria-hidden="true">#</a></h3><p>scripty \u6BD4\u4E0A\u9762\u6F14\u793A\u7684\u8981\u66F4\u5F3A\u5927\uFF0C\u4E5F\u652F\u6301\u901A\u914D\u7B26\u8FD0\u884C\u3001\u811A\u672C\u5E76\u884C\u7B49\u7279\u6027\u3001\u9759\u9ED8\u6A21\u5F0F\uFF0C\u5982\u679C\u6709\u9700\u6C42\u53EF\u4EE5\u9605\u8BFB\u5B98\u65B9\u7684 <a href="https://github.com/testdouble/scripty#advanced-usage" target="_blank" rel="noreferrer">README.md</a>\uFF0C\u6BD5\u7ADF\u54B1\u4EEC\u5DF2\u7ECF\u5165\u95E8\u4E86\uFF0C\u4E0D\u662F\u4E48\uFF1F</p><hr><blockquote><p>\u672C\u8282\u7528\u5230\u7684\u4EE3\u7801\u89C1 <a href="https://github.com/wangshijun/automated-workflow-with-npm-script/tree/07-manage-complexity-using-scripty" target="_blank" rel="noreferrer">GitHub</a>\uFF0C\u60F3\u8FB9\u770B\u8FB9\u52A8\u624B\u7EC3\u4E60\u7684\u540C\u5B66\u53EF\u4EE5\u62C9\u4E0B\u6765\u81EA\u5DF1\u6539\uFF0C\u6CE8\u610F\u5207\u6362\u5230\u6B63\u786E\u7684\u5206\u652F <code>07-manage-complexity-using-scripty</code>\u3002</p></blockquote><hr>`,40),c=[o];function t(r,l,i,u,v,d){return n(),a("div",null,c)}const C=s(p,[["render",t]]);export{A as __pageData,C as default};
